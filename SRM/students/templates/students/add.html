{% extends 'base.html' %}
{% load static %}

{% block title %}Add New Student{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row mb-4">
        <div class="col-md-8">
            <h2><i class="fas fa-user-plus me-2"></i>Add New Student</h2>
            <p class="text-muted">Fill in the details to register a new student</p>
        </div>
        <div class="col-md-4 text-end">
            <a href="{% url 'student_list' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left me-2"></i>Back to List
            </a>
        </div>
    </div>
    
    <form method="POST" enctype="multipart/form-data" novalidate>
        {% csrf_token %}
        
        {% if form.non_field_errors %}
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                {{ form.non_field_errors }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        {% endif %}
        
        <!-- Login Credentials Section -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-lock me-2"></i>Login Credentials</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.username.id_for_label }}" class="form-label">
                            Username <span class="text-danger">*</span>
                        </label>
                        {{ form.username }}
                        {% if form.username.errors %}
                            <div class="text-danger small mt-1">{{ form.username.errors }}</div>
                        {% endif %}
                        <small class="form-text text-muted">{{ form.username.help_text }}</small>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.password.id_for_label }}" class="form-label">
                            Password <span class="text-danger">*</span>
                        </label>
                        {{ form.password }}
                        {% if form.password.errors %}
                            <div class="text-danger small mt-1">{{ form.password.errors }}</div>
                        {% endif %}
                        <small class="form-text text-muted">{{ form.password.help_text }}</small>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.email.id_for_label }}" class="form-label">
                            Email <span class="text-danger">*</span>
                        </label>
                        {{ form.email }}
                        {% if form.email.errors %}
                            <div class="text-danger small mt-1">{{ form.email.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Personal Information Section -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-user me-2"></i>Personal Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.first_name.id_for_label }}" class="form-label">
                            First Name <span class="text-danger">*</span>
                        </label>
                        {{ form.first_name }}
                        {% if form.first_name.errors %}
                            <div class="text-danger small mt-1">{{ form.first_name.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.last_name.id_for_label }}" class="form-label">
                            Last Name <span class="text-danger">*</span>
                        </label>
                        {{ form.last_name }}
                        {% if form.last_name.errors %}
                            <div class="text-danger small mt-1">{{ form.last_name.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.date_of_birth.id_for_label }}" class="form-label">
                            Date of Birth <span class="text-danger">*</span>
                        </label>
                        {{ form.date_of_birth }}
                        {% if form.date_of_birth.errors %}
                            <div class="text-danger small mt-1">{{ form.date_of_birth.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.gender.id_for_label }}" class="form-label">
                            Gender <span class="text-danger">*</span>
                        </label>
                        {{ form.gender }}
                        {% if form.gender.errors %}
                            <div class="text-danger small mt-1">{{ form.gender.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.blood_group.id_for_label }}" class="form-label">
                            Blood Group
                        </label>
                        {{ form.blood_group }}
                        {% if form.blood_group.errors %}
                            <div class="text-danger small mt-1">{{ form.blood_group.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.nationality.id_for_label }}" class="form-label">
                            Nationality <span class="text-danger">*</span>
                        </label>
                        {{ form.nationality }}
                        {% if form.nationality.errors %}
                            <div class="text-danger small mt-1">{{ form.nationality.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.category.id_for_label }}" class="form-label">
                            Category <span class="text-danger">*</span>
                        </label>
                        {{ form.category }}
                        {% if form.category.errors %}
                            <div class="text-danger small mt-1">{{ form.category.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-8 mb-3">
                        <label for="{{ form.photo.id_for_label }}" class="form-label">
                            Photo
                        </label>
                        {{ form.photo }}
                        {% if form.photo.errors %}
                            <div class="text-danger small mt-1">{{ form.photo.errors }}</div>
                        {% endif %}
                        <small class="form-text text-muted">Upload student photo (JPG, PNG)</small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Academic Information Section -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-graduation-cap me-2"></i>Academic Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.enrollment_number.id_for_label }}" class="form-label">
                            Enrollment Number <span class="text-danger">*</span>
                        </label>
                        {{ form.enrollment_number }}
                        {% if form.enrollment_number.errors %}
                            <div class="text-danger small mt-1">{{ form.enrollment_number.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.program.id_for_label }}" class="form-label">
                            Program <span class="text-danger">*</span>
                        </label>
                        {{ form.program }}
                        {% if form.program.errors %}
                            <div class="text-danger small mt-1">{{ form.program.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.batch_year.id_for_label }}" class="form-label">
                            Batch Year <span class="text-danger">*</span>
                        </label>
                        {{ form.batch_year }}
                        {% if form.batch_year.errors %}
                            <div class="text-danger small mt-1">{{ form.batch_year.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.current_semester.id_for_label }}" class="form-label">
                            Current Semester <span class="text-danger">*</span>
                        </label>
                        {{ form.current_semester }}
                        {% if form.current_semester.errors %}
                            <div class="text-danger small mt-1">{{ form.current_semester.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.admission_date.id_for_label }}" class="form-label">
                            Admission Date <span class="text-danger">*</span>
                        </label>
                        {{ form.admission_date }}
                        {% if form.admission_date.errors %}
                            <div class="text-danger small mt-1">{{ form.admission_date.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.admission_type.id_for_label }}" class="form-label">
                            Admission Type <span class="text-danger">*</span>
                        </label>
                        {{ form.admission_type }}
                        {% if form.admission_type.errors %}
                            <div class="text-danger small mt-1">{{ form.admission_type.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Contact Information Section -->
        <div class="card mb-4">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0"><i class="fas fa-address-book me-2"></i>Contact Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.personal_phone.id_for_label }}" class="form-label">
                            Phone Number <span class="text-danger">*</span>
                        </label>
                        {{ form.personal_phone }}
                        {% if form.personal_phone.errors %}
                            <div class="text-danger small mt-1">{{ form.personal_phone.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.personal_email.id_for_label }}" class="form-label">
                            Personal Email
                        </label>
                        {{ form.personal_email }}
                        {% if form.personal_email.errors %}
                            <div class="text-danger small mt-1">{{ form.personal_email.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-12 mb-3">
                        <label for="{{ form.address.id_for_label }}" class="form-label">
                            Address <span class="text-danger">*</span>
                        </label>
                        {{ form.address }}
                        {% if form.address.errors %}
                            <div class="text-danger small mt-1">{{ form.address.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.city.id_for_label }}" class="form-label">
                            City <span class="text-danger">*</span>
                        </label>
                        {{ form.city }}
                        {% if form.city.errors %}
                            <div class="text-danger small mt-1">{{ form.city.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.state.id_for_label }}" class="form-label">
                            State <span class="text-danger">*</span>
                        </label>
                        {{ form.state }}
                        {% if form.state.errors %}
                            <div class="text-danger small mt-1">{{ form.state.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-4 mb-3">
                        <label for="{{ form.pincode.id_for_label }}" class="form-label">
                            Pincode <span class="text-danger">*</span>
                        </label>
                        {{ form.pincode }}
                        {% if form.pincode.errors %}
                            <div class="text-danger small mt-1">{{ form.pincode.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Guardian Information Section -->
        <div class="card mb-4">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0"><i class="fas fa-user-friends me-2"></i>Guardian Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.guardian_name.id_for_label }}" class="form-label">
                            Guardian Name <span class="text-danger">*</span>
                        </label>
                        {{ form.guardian_name }}
                        {% if form.guardian_name.errors %}
                            <div class="text-danger small mt-1">{{ form.guardian_name.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.guardian_relation.id_for_label }}" class="form-label">
                            Relation <span class="text-danger">*</span>
                        </label>
                        {{ form.guardian_relation }}
                        {% if form.guardian_relation.errors %}
                            <div class="text-danger small mt-1">{{ form.guardian_relation.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.guardian_phone.id_for_label }}" class="form-label">
                            Guardian Phone <span class="text-danger">*</span>
                        </label>
                        {{ form.guardian_phone }}
                        {% if form.guardian_phone.errors %}
                            <div class="text-danger small mt-1">{{ form.guardian_phone.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.guardian_email.id_for_label }}" class="form-label">
                            Guardian Email
                        </label>
                        {{ form.guardian_email }}
                        {% if form.guardian_email.errors %}
                            <div class="text-danger small mt-1">{{ form.guardian_email.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-12 mb-3">
                        <label for="{{ form.guardian_occupation.id_for_label }}" class="form-label">
                            Guardian Occupation
                        </label>
                        {{ form.guardian_occupation }}
                        {% if form.guardian_occupation.errors %}
                            <div class="text-danger small mt-1">{{ form.guardian_occupation.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Previous Education Section -->
        <div class="card mb-4">
            <div class="card-header" style="background-color: #8b5cf6; color: white;">
                <h5 class="mb-0"><i class="fas fa-book-reader me-2"></i>Previous Education</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.previous_institution.id_for_label }}" class="form-label">
                            Previous Institution
                        </label>
                        {{ form.previous_institution }}
                        {% if form.previous_institution.errors %}
                            <div class="text-danger small mt-1">{{ form.previous_institution.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.previous_degree.id_for_label }}" class="form-label">
                            Previous Degree
                        </label>
                        {{ form.previous_degree }}
                        {% if form.previous_degree.errors %}
                            <div class="text-danger small mt-1">{{ form.previous_degree.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.previous_percentage.id_for_label }}" class="form-label">
                            Previous Percentage
                        </label>
                        {{ form.previous_percentage }}
                        {% if form.previous_percentage.errors %}
                            <div class="text-danger small mt-1">{{ form.previous_percentage.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="{{ form.previous_passing_year.id_for_label }}" class="form-label">
                            Passing Year
                        </label>
                        {{ form.previous_passing_year }}
                        {% if form.previous_passing_year.errors %}
                            <div class="text-danger small mt-1">{{ form.previous_passing_year.errors }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Additional Options Section -->
        <div class="card mb-4">
            <div class="card-header bg-dark text-white">
                <h5 class="mb-0"><i class="fas fa-cog me-2"></i>Additional Options</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            {{ form.is_hostel_resident }}
                            <label class="form-check-label" for="{{ form.is_hostel_resident.id_for_label }}">
                                {{ form.is_hostel_resident.label }}
                            </label>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            {{ form.is_scholarship_holder }}
                            <label class="form-check-label" for="{{ form.is_scholarship_holder.id_for_label }}">
                                {{ form.is_scholarship_holder.label }}
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="card">
            <div class="card-body">
                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-save me-2"></i>Add Student
                    </button>
                    <a href="{% url 'student_list' %}" class="btn btn-secondary btn-lg">
                        <i class="fas fa-times me-2"></i>Cancel
                    </a>
                </div>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    .card-header {
        border-radius: 0.375rem 0.375rem 0 0;
    }
    
    .form-label {
        font-weight: 500;
    }
    
    .text-danger {
        font-weight: 600;
    }
</style>
{% endblock %}